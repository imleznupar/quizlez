<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://code.responsivevoice.org/responsivevoice.js?key=auvTMQpf"></script>
</head>
<body>
    <head>Quizlez(nupar)</head>
    <div id="menu">
        <p>input list of vocab</p>
        <textarea id="input">1,2,3</textarea>
        <p>separate by</p>
        <input type="text" id="separation" value=",">
        <button id="submit">Submit</button>
    </div>
    <div id="testing" style="display: none;">
        <input id="ans" type="text">
        <button onclick="playSound()">play</button>
        <button onclick="checkAns()">submit</button>
    </div>
    <div id="result" style="display: none;">
        <p id="resultText"></p>
        <button onclick="nextWord()">Ok</button>
    </div>
    <div id="end" style="display: none;">
        <p id="finalResultText"></p>
        <button onclick="restart()">restart</button>
        <button onclick="menu()">back to menu</button>
    </div>
    <script>
        var vocab = []
        var currentWord = -1
        var separation = ""
        var correct = []
        var incorrect = []
        document.getElementById("submit").addEventListener('click',function() {
            responsiveVoice.setDefaultVoice("Chinese Female");
            separation = document.getElementById('separation').value
            vocab = document.getElementById("input").value.split(separation)
            for(let i=0;i<vocab.length;i++)
            {
                vocab[i] = vocab[i].trim()
            }
            shuffle(vocab)
            console.log(vocab)
            document.getElementById("menu").style.display = "none"
            nextWord()
        })

        function nextWord() {
            currentWord+=1
            if(currentWord<vocab.length)
            {
                console.log("words left")
                document.getElementById("testing").style.display = "flex"
                document.getElementById("result").style.display = "none"
                document.getElementById("ans").value = ""
                playSound()
            } else {
                console.log("no words left")
                document.getElementById("end").style.display = "flex"
                document.getElementById("result").style.display = "none"
                document.getElementById("finalResultText").innerHTML = "You got "+correct.length+" / "+vocab.length+" !<br>Correct: "+correct+"<br>Incorrect: "+incorrect
            }
            
        }

        function playSound() {
            responsiveVoice.speak(vocab[currentWord])
        }

        function checkAns() {
            document.getElementById("testing").style.display = "none"
            document.getElementById("result").style.display = "flex"
            if(vocab[currentWord] == document.getElementById("ans").value)
            {
                document.getElementById("resultText").innerHTML = "Correct!"
                correct.push(vocab[currentWord])
            } else {
                document.getElementById("resultText").innerHTML = "Wrong, the correct word is: "+vocab[currentWord]
                incorrect.push(vocab[currentWord]+" ("+document.getElementById("ans").value+")")
            }
        }

        function restart() {
            currentWord = -1
            correct = []
            incorrect = []
            shuffle(vocab)
            console.log(vocab)
            document.getElementById("end").style.display = "none"
            document.getElementById("ans").value = ""
            nextWord()
        }

        function menu() {
            vocab = []
            currentWord = -1
            separation = ""
            correct = []
            incorrect = []
            document.getElementById("end").style.display = "none"
            document.getElementById("menu").style.display = "flex"
            document.getElementById("input").value = ""
            document.getElementById("separation").value = ""
        }

        function shuffle(array) { //Fisher-Yates Shuffle
            for (let i = array.length - 1; i > 0; i--) {
                let j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }
    </script>
</body>
</html>